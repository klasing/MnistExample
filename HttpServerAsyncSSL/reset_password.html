<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>reset password</title>
<style>
.button
{
  color: #808080;
  font-family: verdana;
  border: none;
  background-color: #FFFFFF;
}
label
{
  color: #808080;
  font-family: verdana;
}
.reset_password_result, .reset_password_confirm_result
{
  color: #808080;
  font-family: verdana;
}
.reset_password_confirm
{
  display: none;
}
</style>
<script>
var user_email_address = "";
var user_password = "";
function doResetPassword()
{
  console.log("doResetPassword()");

  // get the values from a form, to create the payload for a POST request
  user_email_address = document.getElementById("user_email_address").value;
  user_password = document.getElementById("user_password").value;
  var payload_for_post = "user_email_address=" + user_email_address + "&" + "user_password=" + user_password;
  console.log("payload_for_post: " + payload_for_post);

  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function()
  {
    if (this.readyState == 4 && this.status == 200)
    {
      document.getElementById("reset_password_result").innerHTML = this.responseText;
      if (this.responseText == "reset_password: enter the code received by email.")
      {
        // hide the fist 'submit' button
        document.getElementById("button_reset_password").style.display = "none";
        // show the 'reset_password_confirm' form
        document.getElementById("reset_password_confirm").style.display = "block";
      }
    }
  }
  xhttp.open("POST", "https://www.localhost.com:8080/reset_password", true);
  xhttp.send(payload_for_post);

  // hide the first 'submit' button
  //document.getElementById("button").style.display = "none";
  // show the 'reset_password_confirm' form
  //document.getElementById("reset_password_confirm").style.display = "block";
}
function doConfirm()
{
  console.log("doConfirm()");

  // get the value from the 'code_confirm' field, to create the payload for a POST request
  var code_confirm = document.getElementById("code_confirm").value;
  var payload_for_post = "user_email_address=" + user_email_address + "&" + "user_password=" + user_password + "&" + "code_confirm=" + code_confirm;
  console.log("payload_for_post: " + payload_for_post);

  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function()
  {
    if (this.readyState == 4 && this.status == 200)
    {
      document.getElementById("reset_password_confirm_result").innerHTML = this.responseText;
    }
  }
  xhttp.open("POST", "https://www.localhost.com:8080/reset_password_confirm", true);
  xhttp.send(payload_for_post);

  //document.getElementById("reset_password_confirm_result").innerHTML = "password is reset";
  // hide the second 'submit' button
  document.getElementById("button_reset_password_confirm").style.display = "none";
}
</script>
</head>
<body>
<div class="reset_password" id="reset_password">
<form>
<label for="user_email_address">email address</label>
<br>
<input type="text" name="user_email_address" id="user_email_address" autocomplete="email" required>
<br>
<label for="user_password">password</label>
<br>
<input type="password" name="user_password" id="user_password" autocomplete="password" required>
<br><br>
<input class="button" id="button_reset_password" type="button" value="submit" onclick="doResetPassword()">
<br>
<p class="reset_password_result" id="reset_password_result"></p>
</form>
</div>

<div class="reset_password_confirm" id="reset_password_confirm">
<form>
<label for="code_confirm">enter the code received by email</label>
<br>
<input type="text" name="code_confirm" id="code_confirm" autocomplete="code" required>
<br><br>
<input class="button" id="button_reset_password_confirm" type="button" value="submit" onclick="doConfirm()">
<br>
<p class="reset_password_confirm_result" id="reset_password_confirm_result"></p>
</form>
</div>

</body>
</html>
